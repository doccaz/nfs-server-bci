# Default values for nfs-server-bci.

image:
  repository: ghcr.io/doccaz/nfs-server-bci
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: "latest"

# Configuration for the NFS Server
nfs:
  # The directory INSIDE the container to export
  exportPath: /data
  # The subnet or IP allowed to connect (default: * for everyone)
  allowedClients: "*"
  # Arguments for the export file (fsid=0 is required for NFSv4 root export on ext4)
  exportOptions: "rw,fsid=0,no_subtree_check,no_root_squash,insecure,sync"

# Critical: Where is the data physically stored on the Host?
persistence:
  hostPath: /var/lib/harvester/defaultdisk/nfs-share
  # Use Directory if path exists, DirectoryOrCreate if you want Kubelet to try (beware SELinux)
  type: Directory

# Critical: Which node should run the NFS server? (Storage is local, so this must be pinned)
nodeSelector:
  kubernetes.io/hostname: "harv01lab"

# Networking
# We use hostNetwork: true to bypass CNI and expose NFS directly on the node IP.
hostNetwork: true

# Security Configuration
securityContext:
  privileged: true
  runAsUser: 0
  capabilities:
    add: ["SYS_ADMIN", "SETPCAP", "DAC_READ_SEARCH"]

# Resource limits (adjust based on load)
resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 128Mi

# Optional: Create a StorageClass automatically?
storageClass:
  enabled: true
  name: harvester-nfs-csi
  # You MUST set this to the IP of the node defined in nodeSelector above
  serverIP: "192.168.86.245"
  # Default mount options for clients
  mountOptions:
    - nfsvers=4.1
  reclaimPolicy: Delete
  